$(document).ready(function(){function e(e,a){var t=e.split("/")[3],n=e.split("/")[4],s="https://api.github.com/repos/"+t+"/"+n+"/readme";$.ajax({url:s,headers:{accept:"application/vnd.github.v3.html"},success:a})}function a(e){var a=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return a.test(e)}var t,n,s=!0,o=!1,r="https://raw.githubusercontent.com/lockys/awesome.json/master/name-map/awesome.json",l={keys:["name"]},c=$(".readme-container"),i=$(".search-result"),h=$(".search-input"),d=$(".mui-dropdown__menu"),u=$(".mui-dropdown"),p=function(r,p){var m="awesome";if(o="awesome"===p?1:0,s=!o,jsonURL="https://raw.githubusercontent.com/lockys/awesome.json/master/output/"+p+".json",awesomeJsonURL="https://raw.githubusercontent.com/lockys/awesome.json/master/awesome/awesome.json",u.removeClass("content-hidden"),i.addClass("content-hidden"),i.html(""),d.html(""),$(".alert").html(""),$(".awesome-input").val(""),o)$(".cate").html(m),$.getJSON(awesomeJsonURL,function(e){var a=e,t=[],s=$(".awesome-cate");s.html(""),Object.keys(a).forEach(function(e){var n=e.replace(/\W/g,"").toLowerCase();t=t.concat(a[e]),s.append("<strong>"+e+'</strong><li><ul class="'+n+'-ul"></ul></li>'),a[e].forEach(function(e){var a=$("."+n+"-ul"),t=e.name.replace(/\W/g,"").toLowerCase(),s="";e.description?" - "+e.description:"";s=e.url.split("/").indexOf("github.com")>-1?'<li><a class="'+t+'" href="#repos/'+t+'" data-url="'+e.url+'" data-name="'+e.name+'"><span class="" data-url="'+e.url+'" data-name="'+e.name+'">'+e.name+"</span></a></li>":'<li><a class="'+t+'" href="'+e.url+'" data-name="'+e.name+'" target="_blank"><span class="" data-url="'+e.url+'" data-name="'+e.name+'">'+e.name+"</span></a></li>",a.append(s)})});var o=$("#sidedrawer"),r=$("strong",o);r.next().hide(),r.off("click"),r.on("click",function(){r.not(this).next().hide(),$(this).next().slideToggle(300)}),n=new Fuse(t,l)}),u.addClass("content-hidden");else{var f=r.url,w='<a href="'+f+'" class="origin-repo-btn" target="_blank">View on <i class="fa fa-github"></i></a><br/><br/>';m=r.name,$(".cate").html(m),c.html('<div class="sk-spinner sk-spinner-pulse"></div>'),e(f,function(e){c.html("").append(w).append(e);for(var t,n=$("h6 a, h5 a, h4 a, h3 a, h2 a, h1 a"),s=f.split("/")[3],o=f.split("/")[4],r="https://raw.githubusercontent.com/"+s+"/"+o+"/master/",l="style=",i=$("img"),h=0,p=i.length;p>h;++h){var m=$(i[h]).attr("src");a(m)||$(i[h]).attr("src",r+m)}for(var h=0,p=n.length;p>h;++h)n[h].id=n[h].id.replace("user-content-",""),l="style=",n[h].id&&(t=$(n[h]).parent()[0].nodeName,"H1"===t?l+='"font-size: 18px;"':"H2"===t?l+='"font-size: 16px; color:#3C3C3C;"':"H3"===t?l+='"font-size: 14px; color:#7B7B7B;"':"H4"===t?l+='"font-size: 12px; color:#ADADAD;"':"H5"===t?l+='"font-size: 12px; color:#D9006C;"':"H6"===t&&(l+='"font-size: 12px; color:#EA0000;"'),d.append("<li><a "+l+' href="#'+n[h].id+'">'+$(n[h]).parent("h6, h5, h4, h3, h2, h1").text()+"</a></li>"));u.removeClass("content-hidden")}),$.getJSON(jsonURL,function(e){var a=e,n=[];return h.removeClass("content-hidden"),0===Object.keys(a).length?(s=!1,$(".alert").html('<span style="color: red;">This repo has not been parsed yet, so what you search is awesome repo</span><br/>'),void h.addClass("content-hidden")):(a.forEach(function(e){n=n.concat(e)}),void(t=new Fuse(n,l)))})}};$("input").on("input",function(e){var a=$(e.target).hasClass("cate-input"),r=$(this).val(),l=15;i=a?$(".cate-search-result"):$(".search-result"),i.removeClass("content-hidden"),i.html(""),r||i.addClass("content-hidden");var c=a?n.search(r):t.search(r),h="";c.length||i.html("No result :(");for(var d=0,u=l;u>d;++d)if(c[d]){var p=c[d].name.replace(/\W/g,"").toLowerCase(),m=' href="'+c[d].url+'" ';o&&(m=""),h=c[d].description?" - "+c[d].description+"</br>":"<br/>",s&&!a?i.append('<a class="'+p+' search-repo-link"'+m+'data-url="'+c[d].url+'" data-name="'+c[d].name+'" target="_blank">'+c[d].name+"</a>"+h):c[d].url.split("/").indexOf("github.com")>-1?i.append('<a class="'+p+' search-repo-link" data-url="'+c[d].url+'" data-name="'+c[d].name+'" href="#/repos/'+p+'">'+c[d].name+"</a>"+h):i.append('<a class="'+p+' search-repo-link" data-url="'+c[d].url+'" data-name="'+c[d].name+'" href="'+c[d].url+'" target="_blank">'+c[d].name+"</a>"+h)}});var m=Backbone.Router.extend({routes:{"repos/:cate":"getRepos","":"getAwesome"}}),f=new m;f.on("route:getRepos",function(e){var a={};$.getJSON(r,function(t){for(var n=t,s=Object.keys(n),o=0,r=s.length;r>o;++o)if(s[o].replace(/\W/g,"").toLowerCase()===e){a={name:s[o],url:n[s[o]]},$(".search-holder").html("Search the "+a.name),p(a,e);break}})}),f.on("route:getAwesome",function(){p(null,"awesome")}),$("body").click(function(e){$(e.target).hasClass("home-button")&&(e.preventDefault(),window.location.hash="/",p(null,"awesome")),$(e.target).hasClass("awesome-input")&&$(e.target).hasClass("search-result")||($(".awesome-input").val(""),$(".search-result").addClass("content-hidden")),$(e.target).hasClass("cate-input")&&$(e.target).hasClass("cate-search-result")||($(".cate-input").val(""),$(".cate-search-result").addClass("content-hidden"))}),p(null,"awesome"),window.location.hash="/",Backbone.history.start()}),jQuery(function(e){function a(){var a={onclose:function(){s.removeClass("active").appendTo(document.body)}},t=e(mui.overlay("on",a));s.appendTo(t),setTimeout(function(){s.addClass("active")},20)}function t(){n.toggleClass("hide-sidedrawer")}var n=e("body"),s=e("#sidedrawer");e(".js-show-sidedrawer").on("click",a),e(".js-hide-sidedrawer").on("click",t),e(".to-top-arrow").click(function(){return console.log(e("html, body")),e("html, body").animate({scrollTop:0},600),!1})});